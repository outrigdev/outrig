<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Outrig</title>
        <link
            rel="stylesheet"
            href="/frontend/app.css"
            id="main-stylesheet"
            onload="window.outrigCssLoaded = true; document.dispatchEvent(new Event('outrig-css-loaded'));"
        />
        <script>
            function onCssLoaded() {
                if (window.outrigCssLoaded) return;
                window.outrigCssLoaded = true;
                document.dispatchEvent(new Event("outrig-css-loaded"));
            }

            function checkCssLoaded(hrefPart) {
                const links = document.querySelectorAll('link[rel="stylesheet"]');
                for (const link of links) {
                    if (link.href.includes(hrefPart)) {
                        if (link.sheet) {
                            onCssLoaded();
                        } else {
                            link.addEventListener("load", onCssLoaded);
                        }
                        break;
                    }
                }
            }
            // Set the initial background color based on theme to prevent flash
            (function () {
                const isDarkMode = localStorage.getItem("theme") === "dark";
                document.documentElement.dataset.theme = isDarkMode ? "dark" : "light";
                // Set body background color after DOM is loaded
                document.addEventListener("DOMContentLoaded", function () {
                    document.body.style.backgroundColor = isDarkMode ? "#0c0c0c" : "#f9fafb";
                    checkCssLoaded("/assets/");
                });
            })();
        </script>
    </head>
    <body>
        <div id="root"></div>
        <script type="module" src="/frontend/main.tsx"></script>
    </body>
</html>
